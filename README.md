# qsay

**qsay** is a local-first tool for inspecting and softening stylistic quirks in Japanese text.

qsay は、日本語文章に現れる **書き癖・表記癖・体裁上の癖** を検出し、
文章の意味・論理・主張を変えることなく、
**「過度に整いすぎた印象」「一目で違和感を覚える体裁」だけを緩和する**
ローカル完結型の文章鑑識・校正ツールである。

---

## 目的

qsay は次の問いに答えるための道具である。

- なぜこの文章は「機械的に見える」のか
- どこが「一目でAIっぽい」と感じさせるのか

qsay は **出自を断定しない**。
AI生成かどうかを裁定するツールではない。

---

## qsay がしないこと

- AI生成かどうかを断定しない
- 文章の意味・論理構造・主張を作り替えない
- 採点・ランキング・処分の根拠にならない
- 機械学習・統計モデルを使用しない

qsay が扱うのは **体裁と表記に現れる「癖」だけ** である。

---

## 設計思想

> qsay は文章を「良くする」ツールではない。
> 文章から「そう見えてしまう理由」を剥がすための道具である。

- 意味を触らない
- 書き手の立場を奪わない
- 見た目・構造・表記だけを扱う
- 誤検出を恐れ、人を疑わない

このため、qsay の検出・修正はすべて
**説明可能なルールベース** で行われる。

---

## 検出ルール（34種）

34の検出ルールを **Visual**（体裁の癖）と **Structural**（構造・文体の癖）の2軸に分類する。

### Visual（16ルール）

| ID | 癖 | 自動修正 |
|------|------|:------:|
| DR-16 | 箇条書き直前の「：」 | ✓ |
| DR-17 | 箇条書き行頭の絵文字 | ✓（全削除） |
| DR-18 | 「」で囲まれた引用が単独行 | ✓ |
| DR-20 | 「以下の〜」の過剰使用 | ✓ |
| DR-21 | 箇条書き項目数が3〜5に偏る | — |
| DR-22 | 箇条書き文末表現の完全一致 | ✓ |
| DR-23 | 教科書的な太字強調の多用 | ✓ |
| DR-24 | 段落構造の過度な均一性 | — |
| DR-25 | 導入＋結語のテンプレート | — |
| DR-26 | 見出し構造が均一すぎる | — |
| DR-27 | 括弧内注釈の過剰使用 | ✓ |
| DR-28 | 「〜とは」定義文の反復 | — |
| DR-29 | 箇条書き＋要約文の反復構造 | — |
| DR-43 | 全角半角混在 | ✓（全修正） |
| DR-44 | 数字表記の揺れ | — |
| DR-45 | 記号混在（～/〜、.../…） | ✓（全修正） |

### Structural（18ルール）

| ID | 癖 | 自動修正 |
|------|------|:------:|
| DR-02 | 文長の均一性 | — |
| DR-04 | 定型接続語の高密度使用 | — |
| DR-05 | 文末表現の単調さ | — |
| DR-07 | 抽象名詞の高密度使用 | — |
| DR-09 | 思考の痕跡の欠如 | — |
| DR-10 | 受身表現の偏り | — |
| DR-11 | 指示語の不自然な少なさ | — |
| DR-12 | 漢語率の異常な高さ | — |
| DR-34 | カタカナビジネス用語の集中 | — |
| DR-35 | 列挙マーカーの機械的使用 | — |
| DR-36 | 文頭パターンの反復 | — |
| DR-37 | 名詞化冗長表現 | — |
| DR-38 | 冗長定型句 | — |
| DR-39 | 文体混在（です/ます × だ/である） | ✓（全修正） |
| DR-40 | 思考保留表現の多用 | — |
| DR-41 | 強調語の過密 | ✓ |
| DR-42 | 視点（人称）の混在 | — |
| DR-46 | 疑問＋断定の不自然な近接 | — |

各ルールの設計意図は [docs/rules.md](docs/rules.md) を参照。

---

## スコアについて

qsay は **AIスコア** を提示しない。

代わりに2軸で示す：

- **Visual Kuse Score** — 体裁上の癖がどの程度集中しているかの目安
- **Structural Kuse Score** — 構造・文体・語彙の癖がどの程度集中しているかの目安

数値は補助的なものであり、
重要なのは **どこに癖があるか** である。

---

## 使用方法

### Web UI

`qsay-web.html` をブラウザで開く。サーバ不要、単一ファイルで動作。

3タブ構成：

| タブ | 機能 |
|------|------|
| 解析 | 34ルールで検出、Visual/Structural スコア表示 |
| 修正 | 11種の自動修正（3層制御）、Before/After、diff |
| プロンプト | 18パターンの構造・文体修正プロンプト生成、コピー→AI貼付 |

---

## 校正の仕組み

### 自動修正（11ルール）

正規表現で置換でき、意味が変わらない癖を自動修正する。

**全削除（Global Cap 外）** — 表記正規化。上限なし。
- DR-17 絵文字→ダッシュ
- DR-39 文体を多数派に統一
- DR-43 全角英数字→半角
- DR-45 記号を統一

**上限付き（Global Cap 内）** — 3層制御で制限。
- DR-16 「：」→「。」
- DR-18 引用を前後と結合
- DR-20 「以下の」の2回目以降を削除
- DR-22 箇条書き文末を1箇所変更
- DR-23 太字を1つおきに解除
- DR-27 括弧を外す（3個目以降）
- DR-41 強調語を削除（3個目以降）

### 3層制御

| レイヤ | 制御 | 意図 |
|--------|------|------|
| ① Global Cap | 最大8件 | やりすぎ感の防止 |
| ② Per-Rule Cap | ルール別上限 | 同じ癖を全部潰さない |
| ③ Local Cap | 段落あたり2件 | 文章の性格を急変させない |

### プロンプト出力（18パターン）

自動修正が難しいルールについて、AIに投げるための修正プロンプトを生成する。

対象: DR-02, DR-04, DR-05, DR-07, DR-09, DR-11, DR-21, DR-24, DR-25, DR-34, DR-35, DR-36, DR-37, DR-38, DR-40, DR-42, DR-44, DR-46

### 検出のみ（5ルール）

修正指示が文脈依存すぎるため、検出結果の提示のみ行う。

対象: DR-10, DR-12, DR-26, DR-28, DR-29

---

## 注意事項（重要）

- 短文では検出精度が落ちる
- 推敲された人間文を誤って検出する可能性がある
- 本ツールは単独での判断根拠として使用すべきではない

---

## ファイル構成

```
qsay/
├── qsay-web.html      ← ブラウザで開くだけで動作
├── qsay-web.jsx        ← React ソース
├── docs/
│   ├── rules.md        ← 全34ルールの設計意図
│   ├── rule-classification.md
│   ├── rule-review-2025.md
│   └── roadmap.md
├── CHANGELOG.md
└── README.md
```

---

## ライセンス

TBD

---

## 名前について

**qsay** は、特定の技術や概念を直接指さない名前である。
意味は README によってのみ定義される。
